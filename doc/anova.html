<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Análisis de varianza – Inferencia Estadística</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclusiones.html" rel="next">
<link href="./nopara.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./anova.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Análisis de varianza</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Inferencia Estadística</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis Exploratorio de Datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./para.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estimación y contraste paramétrico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nopara.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contraste no paramétrico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Análisis de varianza</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusiones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliografía</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#modelo-con-un-factor" id="toc-modelo-con-un-factor" class="nav-link active" data-scroll-target="#modelo-con-un-factor"><span class="header-section-number">5.1</span> Modelo con un factor</a></li>
  <li><a href="#modelo-con-dos-factores-con-y-sin-interacción" id="toc-modelo-con-dos-factores-con-y-sin-interacción" class="nav-link" data-scroll-target="#modelo-con-dos-factores-con-y-sin-interacción"><span class="header-section-number">5.2</span> Modelo con dos factores con y sin interacción</a></li>
  <li><a href="#comparaciones-múltiples" id="toc-comparaciones-múltiples" class="nav-link" data-scroll-target="#comparaciones-múltiples"><span class="header-section-number">5.3</span> Comparaciones múltiples</a>
  <ul class="collapse">
  <li><a href="#método-de-bonferroni" id="toc-método-de-bonferroni" class="nav-link" data-scroll-target="#método-de-bonferroni"><span class="header-section-number">5.3.1</span> Método de Bonferroni</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-anova" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Análisis de varianza</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El <strong>análisis de la varianza</strong>, conocido como ANOVA (del inglés <em>Analysis of Variance</em>), es una técnica estadística utilizada para comparar las medias de dos o más grupos y determinar si existen diferencias significativas entre ellos. Se trata de un método desarrollado por <em>R.A. Fisher</em> en las primeras décadas del siglo XX. La idea central es analizar la variabilidad de los datos y dividirla en componentes atribuibles a diferentes fuentes de variación.</p>
<p>En su forma más simple, el ANOVA se utiliza para probar hipótesis sobre las diferencias entre las medias de grupos. Por ejemplo, si quisiéramos comparar el rendimiento de tres tipos diferentes de fertilizantes en el crecimiento de las plantas, podríamos usar ANOVA para determinar si el tipo de fertilizante tiene un efecto significativo en el crecimiento.</p>
<p>El proceso general del ANOVA incluye:</p>
<ol type="1">
<li><p><strong>Formulación de hipótesis</strong>: Se establece una hipótesis nula que indica que no hay diferencias entre las medias de los grupos y una hipótesis alternativa que sugiere que al menos una media es diferente.</p></li>
<li><p><strong>Cálculo de la varianza</strong>: Se calculan dos tipos de varianza: la varianza dentro de los grupos (variabilidad debido a diferencias dentro de los mismos grupos) y la varianza entre los grupos (variabilidad debido a diferencias entre los grupos).</p></li>
<li><p><strong>F-test</strong>: Se realiza una prueba <span class="math inline">\(F\)</span> de Fisher para evaluar la relación entre las varianzas. Si la varianza entre los grupos es significativamente mayor que la varianza dentro de los grupos, esto sugiere que hay diferencias significativas entre las medias de los grupos.</p></li>
<li><p><strong>Análisis de resultados</strong>: Si la prueba <span class="math inline">\(F\)</span> indica que hay diferencias significativas, se pueden realizar pruebas adicionales para identificar entre qué grupos existen estas diferencias.</p></li>
</ol>
<p>El ANOVA es una herramienta poderosa porque permite comparaciones múltiples mientras controla la tasa de error tipo I. Es ampliamente utilizado en experimentos donde se comparan tratamientos o condiciones en diferentes grupos o en diferentes momentos.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Distribución F">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Distribución F
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>La función de distribución F es una distribución de probabilidad que surge principalmente en el análisis de varianza (ANOVA) y en la prueba F de Fisher, utilizada para comparar dos varianzas de muestras independientes. Tal y como veremos en este capítulo, esta distribución es útil para determinar si la variabilidad entre los grupos es mayor que la variabilidad dentro de los grupos.</p>
<p>La distribución F tiene dos parámetros de grados de libertad: uno para el numerador (<span class="math inline">\(df1\)</span>) y otro para el denominador (<span class="math inline">\(df2\)</span>).</p>
<p>Vamos a visualizar la distribución F y calcular valores específicos usando <code>R</code>.</p>
<p>Primero, vamos a graficar la densidad de la distribución F para <span class="math inline">\(df1 = 5\)</span> y <span class="math inline">\(df2 = 10\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la librería necesaria</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ggplot2"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Parámetros de la distribución F</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una secuencia de valores para la variable x</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la densidad de la distribución F</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">df</span>(x, df1, df2)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame para ggplot</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar la densidad de la distribución F</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Distribución F con df1 ="</span>, df1, <span class="st">"y df2 ="</span>, df2),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Valores de F"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densidad"</span>) <span class="sc">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/Dist_f1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico muestra la densidad de la distribución F para los grados de libertad especificados. La forma de la distribución F depende de los valores de df1 y df2. Te animamos a que pruebes diferentes valores de esos dos parámetros usando el código anterior.</p>
<p>Ahora, vamos a calcular valores específicos de la función de distribución acumulativa (CDF) y la función de densidad (PDF) para un valor de F.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor de la función de densidad (PDF) para F = 2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>f_value <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pdf_value <span class="ot">&lt;-</span> <span class="fu">df</span>(f_value, df1, df2)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PDF en F ="</span>, f_value, <span class="st">"es"</span>, pdf_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PDF en F = 2 es 0.1620057 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor de la función de distribución acumulativa (CDF) para F = 2</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cdf_value <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_value, df1, df2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"CDF en F ="</span>, f_value, <span class="st">"es"</span>, cdf_value, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CDF en F = 2 es 0.835805 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el valor crítico de F para un nivel de significancia del 5%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>f_critical <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, df1, df2)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Valor crítico de F para un nivel de significancia del 5% es"</span>, f_critical, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Valor crítico de F para un nivel de significancia del 5% es 3.325835 </code></pre>
</div>
</div>
<p>El valor de la función de densidad para <span class="math inline">\(F = 2\)</span> indica la densidad de probabilidad en ese punto específico.</p>
<p>El valor de la CDF para <span class="math inline">\(F = 2\)</span> indica la probabilidad acumulada de obtener un valor de F menor o igual a <span class="math inline">\(2\)</span>.</p>
<p>El valor crítico de F para un nivel de significancia del <span class="math inline">\(\alpha=0.05\)</span> es el valor de F más allá del cual la probabilidad acumulada es <span class="math inline">\(5\%\)</span>. Este valor se utiliza en pruebas estadísticas para decidir si se rechaza o no la hipótesis nula.</p>
</div>
</div>
</div>
<section id="modelo-con-un-factor" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="modelo-con-un-factor"><span class="header-section-number">5.1</span> Modelo con un factor</h2>
<p>El modelo de ANOVA de un factor se utiliza cuando se estudia el efecto de un solo factor (variable independiente) en una variable dependiente continua. Este modelo permite comparar las medias de varios grupos para determinar si existen diferencias significativas entre ellos.</p>
<ul>
<li><strong>Hipótesis</strong>:
<ul>
<li><strong>Hipótesis Nula (</strong><span class="math inline">\(H_0\)</span>): Todas las medias de los grupos son iguales (<span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_k\)</span>).</li>
<li><strong>Hipótesis Alternativa (</strong><span class="math inline">\(H_a\)</span>): Al menos una de las medias de los grupos es diferente.</li>
</ul></li>
</ul>
<p>Tenemos una variable aleatoria <span class="math inline">\(Y\)</span> que toma valores reales y una variable cualitativa o factor <span class="math inline">\(X\)</span> con <span class="math inline">\(k\)</span> niveles <span class="math inline">\(1,2,\ldots,i,\ldots,k\)</span>. La variable <span class="math inline">\(Y\)</span> toma valores <span class="math inline">\(Y_{ij}, j=1,\ldots,n_i\)</span> en el nivel <span class="math inline">\(i\)</span> del factor <span class="math inline">\(X\)</span>, siendo <span class="math inline">\(n_i\)</span> el número de observaciones en el nivel <span class="math inline">\(i\)</span> del factor <span class="math inline">\(X\)</span>.</p>
<p>Tenemos los siguientes supuestos:</p>
<ul>
<li>Normalidad: Las distribuciones de las poblaciones de las que provienen las muestras son normales.</li>
<li>Homogeneidad de varianzas: Las varianzas de las poblaciones son iguales.</li>
<li>Independencia: Las observaciones son independientes entre sí.</li>
</ul>
<p>Escribimos el modelo como sigue: <span class="math display">\[
  Y_{ij} = \mu + \tau_i + \epsilon_{ij}
\]</span> Donde:</p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span> es la observación <span class="math inline">\(j\)</span>-ésima del grupo <span class="math inline">\(i\)</span>-ésimo.</li>
<li><span class="math inline">\(\mu\)</span> es la media general.</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> es el término de error aleatorio.</li>
<li><span class="math inline">\(\tau_i\)</span> es el efecto del grupo i-ésimo en la media de la variable respuesta <span class="math inline">\(Y\)</span>. Esto es, cuánto aumenta o disminuye la media de <span class="math inline">\(Y\)</span> por pertenecer la observación a la categoría <span class="math inline">\(i\)</span>. De modo que podemos llamar <span class="math display">\[
Y_i=\mu+\tau_i
\]</span> al efecto medio del grupo <span class="math inline">\(i\)</span>-esimo.</li>
</ul>
<p>La suma de las diferencias al cuadrado de cada dato respecto a la media general se calcula como sigue: <span class="math display">\[
    \text{SST} = \sum_{i=1}^{k} \sum_{j=1}^{n_i} (Y_{ij} - \bar{Y}_{..})^2        
\]</span> donde <span class="math inline">\(\bar{Y}_{..}\)</span> es la media general de todas las observaciones.</p>
<p>Teniendo en cuenta que: <span class="math display">\[
Y_{ij} - \bar{Y}_{..}= Y_i  + \epsilon_{ij} - \bar{Y}_{..}
\]</span> Podemos descomponer la suma de cuadrados, como sigue:</p>
<p><span class="math display">\[
    \text{SST} = \sum_{i=1}^{k} \sum_{j=1}^{n_i} (Y_{ij} - \bar{Y}_{..})^2=  \sum_{i=1}^{k} n_i (\bar{Y}_i - \bar{Y}_{..})^2+\sum_{i=1}^{k} \sum_{j=1}^{n_i} (Y_{ij} - \bar{Y}_i)^2      
\]</span></p>
<p>Donde: La varianza entre grupos se calcula como la suma de las diferencias al cuadrado de las medias de los grupos respecto a la media general, ponderada por el tamaño de los grupos: <span class="math display">\[
\text{SSB} = \sum_{i=1}^{k} n_i (\bar{Y}_i - \bar{Y}_{..})^2
\]</span> donde <span class="math inline">\(\bar{Y}_i\)</span> es la media del grupo <span class="math inline">\(i\)</span>.</p>
<p>Además, la varianza dentro de los grupos, se calcula como la suma de las diferencias al cuadrado de cada dato respecto a la media de su grupo se obtiene como: <span class="math display">\[
\text{SSW} = \sum_{i=1}^{k} \sum_{j=1}^{n_i} (Y_{ij} - \bar{Y}_i)^2
\]</span> Esto es, se descompone la variabilidad total de los datos en dos componentes, SSB que refleja la diferencia de cada grupo respecto a la media global y SSW que refleja la variabilidad intrínseca dentro de cada grupo: <span class="math display">\[
\text{SST} = \text{SSB} + \text{SSW}
\]</span></p>
<p><strong>Cálculo del Estadístico F</strong>: <span class="math display">\[
F = \frac{\text{Varianza Entre Grupos (MSB)}}{\text{Varianza Dentro de los Grupos (MSW)}}
\]</span> Donde:</p>
<ul>
<li>MSB (Mean Square Between): Media cuadrática entre grupos.</li>
<li>MSW (Mean Square Within): Media cuadrática dentro de los grupos.</li>
</ul>
<p>Esto es: <span class="math display">\[
F=\frac{SSB/df_B}{SSW/df_W}
\]</span> donde:</p>
<ul>
<li><span class="math inline">\(df_B=k-1\)</span> son los grados de libertad entre los grupos</li>
<li><span class="math inline">\(df_W=N-k\)</span> son los grado sd elibertado dentro de los grupos, siendo <span class="math inline">\(N\)</span> el número total de observaciones.</li>
</ul>
<p>Una vez se dispone de toda esta información, es común representarla en forma de tabla, en la llamada <em>Tabla ANOVA</em>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Fuente de variación</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Disferencias entre grupos</td>
<td>SSB</td>
<td>k-1</td>
<td>MSB</td>
</tr>
<tr class="even">
<td>Diferencias dentro de los grupos, Residual o Error</td>
<td>SSW</td>
<td>N-k</td>
<td>MSW</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>SST</td>
<td>N-1</td>
<td></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-caution callout-titled" title="Para el futuro">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Para el futuro
</div>
</div>
<div class="callout-body-container callout-body">
<p>La proporción de variabilidad explicada por los grupos se calcula como: <span class="math display">\[
R^2=1-SSW/SST
\]</span> Este valor, será muy importante en la asignatura de <em>Regresión</em> del Grado en Ciencia e Ingeniería de Datos.</p>
</div>
</div>
<p>El estadístico de prueba <span class="math inline">\(F \sim F_{df_B,df_W}\)</span> bajo la hipótesis nula de igualdad de medias.</p>
<p>El <span class="math inline">\(p-valor\)</span> se obtiene a partir de la distribución <span class="math inline">\(F\)</span>, considerando los grados de libertad de numerador y denominador. Esto es: <span class="math display">\[
p-valor=P(F_{df_b,df_W}&gt;F_{muestral})
\]</span></p>
<p>Como en otros contrastes, si el <span class="math inline">\(p-valor\)</span> p es menor que el nivel de significancia (<span class="math inline">\(\alpha\)</span>), se rechaza la hipótesis nula, concluyendo que al menos una de las medias de los grupos es diferente.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo. ANOVA de un factor">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo. ANOVA de un factor
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Vamos a realizar un ejemplo completo de ANOVA de un factor, donde calcularemos todos los pasos del contraste, incluidos el valor de F y el p-valor.</p>
<p>Supongamos que tenemos tres tratamientos (A, B y C) y sus correspondientes muestras de datos son:</p>
<ul>
<li>Grupo A: <span class="math inline">\([5, 7, 6, 9, 6]\)</span></li>
<li>Grupo B: <span class="math inline">\([8, 12, 9, 11, 10]\)</span></li>
<li>Grupo C: <span class="math inline">\([14, 10, 13, 15, 12]\)</span></li>
</ul>
<p>Nuestro objetivo es determinar si existe una diferencia significativa entre las medias de estos tres grupos.</p>
<p>En primer lugar calculamos la media de cada grupo y la media general:</p>
<ul>
<li><p>Media de Grupo A (<span class="math inline">\(\bar{Y}_A\)</span>): <span class="math display">\[
\bar{Y}_A = \frac{5 + 7 + 6 + 9 + 6}{5} = \frac{33}{5} = 6.6
\]</span></p></li>
<li><p>Media de Grupo B (<span class="math inline">\(\bar{Y}_B\)</span>): <span class="math display">\[
\bar{Y}_B = \frac{8 + 12 + 9 + 11 + 10}{5} = \frac{50}{5} = 10.0
\]</span></p></li>
<li><p>Media de Grupo C (<span class="math inline">\(\bar{Y}_C\)</span>): <span class="math display">\[
\bar{Y}_C = \frac{14 + 10 + 13 + 15 + 12}{5} = \frac{64}{5} = 12.8
\]</span></p></li>
<li><p>Media General (<span class="math inline">\(\bar{Y}\)</span>): <span class="math display">\[
\bar{Y} = \frac{6.6 + 10.0 + 12.8}{3} = \frac{29.4}{3} \approx 9.8
\]</span></p></li>
</ul>
<p>Calculamos la Suma de Cuadrados entre Grupos (SSB)</p>
<p><span class="math display">\[
\text{SSB} = n_A (\bar{Y}_A - \bar{Y})^2 + n_B (\bar{Y}_B - \bar{Y})^2 + n_C (\bar{Y}_C - \bar{Y})^2
\]</span> donde <span class="math inline">\(n_A = n_B = n_C = 5\)</span> (número de observaciones en cada grupo). Fíjate que el número de observaciones en cada grupo podría ser diferente. En este ejemplo, son iguales.</p>
<p><span class="math display">\[
\text{SSB} = 5 (6.6 - 9.8)^2 + 5 (10.0 - 9.8)^2 + 5 (12.8 - 9.8)^2 =96.4
\]</span></p>
<p>A continuación calculamos la Suma de Cuadrados Dentro de los Grupos (SSW)</p>
<p><span class="math display">\[
\text{SSW} = \sum_{i=1}^{k} \sum_{j=1}^{n_i} (Y_{ij} - \bar{Y}_i)^2
\]</span></p>
<p>Para cada grupo, calculamos la suma de las diferencias al cuadrado entre cada dato y la media del grupo:</p>
<ul>
<li><p>Grupo A: <span class="math display">\[
(5 - 6.6)^2 + (7 - 6.6)^2 + (6 - 6.6)^2 + (9 - 6.6)^2 + (6 - 6.6)^2 = 9.2
\]</span></p></li>
<li><p>Grupo B: <span class="math display">\[
(8 - 10.0)^2 + (12 - 10.0)^2 + (9 - 10.0)^2 + (11 - 10.0)^2 + (10 - 10.0)^2 = 10.0
\]</span></p></li>
<li><p>Grupo C: <span class="math display">\[
(14 - 12.8)^2 + (10 - 12.8)^2 + (13 - 12.8)^2 + (15 - 12.8)^2 + (12 - 12.8)^2 = 14.8
\]</span></p></li>
</ul>
<p>Entonces, la Suma de Cuadrados Dentro de los Grupos (SSW) es: <span class="math display">\[
\text{SSW} = 9.2 + 10.0 + 14.8 = 34.0
\]</span></p>
<p>Tenemos, por tanto que la Suma Total de Cuadrados (SST) es: <span class="math display">\[
\text{SST} = \text{SSB} + \text{SSW} = 96.4 + 34.0 = 130.4
\]</span></p>
<p>Para realizar el contraste, necesitamos calcular los Grados de Libertad del estadístico:</p>
<ul>
<li>Grados de libertad entre los grupos (<span class="math inline">\(\text{df}_B = k-1=3-1=2\)</span>):</li>
<li>Grados de libertad dentro de los grupos (<span class="math inline">\(\text{df}_W=N-k=15-3=12\)</span>):</li>
</ul>
<p>Calcularemos las varianzas como sigue:</p>
<ul>
<li><p>Varianza entre los grupos (MSB): <span class="math display">\[
\text{MSB} = \frac{\text{SSB}}{\text{df}_B} = \frac{96.4}{2} = 48.2
\]</span></p></li>
<li><p>Varianza dentro de los grupos (MSW): <span class="math display">\[
\text{MSW} = \frac{\text{SSW}}{\text{df}_W} = \frac{34.0}{12} \approx 2.8333
\]</span></p></li>
</ul>
<p>Ya estamos en disposición de calcular el estadístico de contraste : <span class="math display">\[
F = \frac{\text{MSB}}{\text{MSW}} = \frac{48.2}{2.8333} \approx 17.01
\]</span></p>
<p>El p-valor se obtiene utilizando la distribución <span class="math inline">\(F\)</span> con <span class="math inline">\(\text{df}_B = 2\)</span> y <span class="math inline">\(\text{df}_W = 12\)</span>. Para este ejemplo, podemos utilizar software estadístico o tablas de distribución F.</p>
<p>Usando R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">17.01</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">12</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003143459</code></pre>
</div>
</div>
<p>El p-valor es muy pequeño, mucho menor que el grado de significancia <span class="math inline">\(\alpha=0.05\)</span>, indicando una diferencia significativa entre los grupos.</p>
</div>
</div>
</div>
</section>
<section id="modelo-con-dos-factores-con-y-sin-interacción" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="modelo-con-dos-factores-con-y-sin-interacción"><span class="header-section-number">5.2</span> Modelo con dos factores con y sin interacción</h2>
<p>El modelo de ANOVA de dos factores se utiliza cuando se estudian dos factores simultáneamente para evaluar su efecto individual y conjunto en una variable dependiente. Podemos verlo como una generalización del caso de ANOVA con un único factor. Este modelo es más complejo y permite entender no solo los efectos principales de cada factor, sino también si existe una interacción entre ellos.</p>
<p>Sean A y B dos factores que se desean estudiar, con <span class="math inline">\(m_A\)</span> y <span class="math inline">\(m_B\)</span> niveles. Trabajaremos con las siguientes hipótesis nulas:</p>
<ul>
<li><strong>Hipótesis</strong>:
<ul>
<li><strong>Hipótesis Nula para los efectos principales (</strong><span class="math inline">\(H_0\)</span>):
<ul>
<li>No hay efecto del primer factor.</li>
<li>No hay efecto del segundo factor.</li>
</ul></li>
<li><strong>Hipótesis Nula para la interacción (</strong><span class="math inline">\(H_0\)</span>): No hay interacción entre los dos factores.</li>
</ul></li>
</ul>
<p><strong>Modelo sin Interacción</strong>:</p>
<p><span class="math display">\[ Y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk} \]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(Y_{ijk}\)</span> es la observación <span class="math inline">\(k\)</span>-ésima del nivel <span class="math inline">\(j\)</span>-ésimo del factor B y nivel <span class="math inline">\(i\)</span>-ésimo del factor A. - <span class="math inline">\(\mu\)</span> es la media general.</li>
<li><span class="math inline">\(\alpha_i\)</span> es el efecto del nivel <span class="math inline">\(i\)</span>-ésimo del factor A.</li>
<li><span class="math inline">\(\beta_j\)</span> es el efecto del nivel <span class="math inline">\(j\)</span>-ésimo del factor B. - <span class="math inline">\(\epsilon_{ijk}\)</span> es el término de error aleatorio.</li>
</ul>
<p>En este caso, la tabla ANOVA queda como sigue:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Fuente de variación</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Diferencias entre niveles del factor A</td>
<td><span class="math inline">\(SSB_A\)</span></td>
<td><span class="math inline">\(m_A-1\)</span></td>
<td><span class="math inline">\(MSB_A\)</span></td>
</tr>
<tr class="even">
<td>Diferencias entre niveles del factor B</td>
<td><span class="math inline">\(SSB_B\)</span></td>
<td><span class="math inline">\(m_B-1\)</span></td>
<td><span class="math inline">\(MSB_B\)</span></td>
</tr>
<tr class="odd">
<td>Error</td>
<td><span class="math inline">\(SSW\)</span></td>
<td><span class="math inline">\(N-m_A-m_B+1\)</span></td>
<td><span class="math inline">\(MSW\)</span></td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(SST\)</span></td>
<td><span class="math inline">\(N-1\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>Para estudiar la importancia de cada factor se calcula el estadístico <span class="math inline">\(F\)</span> particular para cada uno de ellos como sigue: <span class="math display">\[
F_A=\frac{MSB_A}{MSW} \sim F_{m_A-1,N-m_A-m_B+1}
\]</span> y <span class="math display">\[
F_B=\frac{MSB_B}{MSW}\sim F_{m_B-1,N-m_A-m_B+1}
\]</span> A partir de estos estadísticos de prueba podemos contrastar las hipótesis nulas de no existencia de efectos asociados a los factores <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> respectivamente.</p>
<p><strong>Modelo con Interacción</strong>: <span class="math display">\[ Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{ijk} \]</span></p>
<p>Donde: <span class="math inline">\((\alpha\beta)_{ij}\)</span> representa el efecto de interacción entre el nivel <span class="math inline">\(i\)</span>-ésimo del factor A y el nivel <span class="math inline">\(j\)</span>-ésimo del factor B.</p>
<p>En este caso, la tabla ANOVA añade el factor de interacción:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Fuente de variación</th>
<th>Suma de cuadrados</th>
<th>Grados de libertad</th>
<th>Cuadrado Medio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Diferencias entre niveles del factor A</td>
<td><span class="math inline">\(SSB_A\)</span></td>
<td><span class="math inline">\(m_A-1\)</span></td>
<td><span class="math inline">\(MSB_A\)</span></td>
</tr>
<tr class="even">
<td>Diferencias entre niveles del factor B</td>
<td><span class="math inline">\(SSB_B\)</span></td>
<td><span class="math inline">\(m_B-1\)</span></td>
<td><span class="math inline">\(MSB_B\)</span></td>
</tr>
<tr class="odd">
<td>Diferencias debidas la interacción</td>
<td><span class="math inline">\(SSB_{AB}\)</span></td>
<td><span class="math inline">\((m_A-1)*(m_B-1)\)</span></td>
<td><span class="math inline">\(MSB_{AB}\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(SSW\)</span></td>
<td><span class="math inline">\(N-m_A*m_B\)</span></td>
<td><span class="math inline">\(MSW\)</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SST\)</span></td>
<td><span class="math inline">\(N-1\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>Para estudiar la importancia de la interacción se calcula el estadístico <span class="math inline">\(F\)</span> correspondiente:</p>
<p><span class="math display">\[
F_{AB}=\frac{MSB_{AB}}{MSW}\sim F_{(m_A-1)*(m_B-1),N-m_A*m_B}
\]</span></p>
<p>A partir de este estadísticos de prueba podemos contrastar la hipótesis nula de no existencia de interacción entre los dos factores <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>. Si podemos rechazar esa hipótesis, es decir, si existe interacción entre los factores, entonces hemos terminado. Es decir, no podemos eliminar ningún factor del modelo. En cambio, si no rechazamos la hipótesis nula, es decir, si no existe interacción entre los factores, podemos eliminar dicho efecto (la interacción) del modelo y pasar a un modelos sin interacción como el anteriormente descrito.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo. ANOVA de dos factores con interacción">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo. ANOVA de dos factores con interacción
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supongamos que estamos estudiando el efecto de dos factores sobre el rendimiento de los estudiantes: el método de enseñanza (con dos niveles: Tradicional y Experimental) y el tipo de material de estudio (con tres niveles: Libro, Video, y Online). Queremos saber si estos factores, y su posible interacción, tienen un efecto significativo en el rendimiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rendimiento <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">90</span>, <span class="dv">83</span>, <span class="dv">87</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">89</span>, <span class="dv">91</span>, <span class="dv">84</span>, <span class="dv">88</span>, <span class="dv">87</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">75</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">81</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">76</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">90</span>, <span class="dv">92</span>, <span class="dv">91</span>, <span class="dv">93</span>, <span class="dv">90</span>, <span class="dv">89</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">91</span>, <span class="dv">93</span>, <span class="dv">92</span>, <span class="dv">91</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>metodo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Tradicional"</span>, <span class="st">"Experimental"</span>), <span class="at">each=</span><span class="dv">18</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>material <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Libro"</span>, <span class="st">"Video"</span>, <span class="st">"Online"</span>), <span class="at">each=</span><span class="dv">6</span>, <span class="at">times=</span><span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rendimiento, metodo, material)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar los datos</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggline</span>(datos, <span class="at">x =</span> <span class="st">"material"</span>, <span class="at">y =</span> <span class="st">"rendimiento"</span>, <span class="at">color =</span> <span class="st">"metodo"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_se"</span>, <span class="st">"dotplot"</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/datos_anova-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora que tenemos nuestros datos, vamos a realizar el ANOVA de dos factores con interacción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de dos factores con interacción</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(rendimiento <span class="sc">~</span> metodo <span class="sc">*</span> material, <span class="at">data=</span>datos)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value   Pr(&gt;F)    
metodo           1   81.0    81.0   21.83 5.88e-05 ***
material         2  309.7   154.9   41.73 2.16e-09 ***
metodo:material  2  771.2   385.6  103.90 3.26e-14 ***
Residuals       30  111.3     3.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Los resultados del ANOVA se interpretan observando los <span class="math inline">\(p-valores\)</span> para cada uno de los componentes del modelo:</p>
<ul>
<li><strong>metodo</strong>: Efecto principal del método de enseñanza.</li>
<li><strong>material</strong>: Efecto principal del tipo de material de estudio.</li>
<li><strong>metodo:material</strong>: Interacción entre el método de enseñanza y el tipo de material de estudio.</li>
</ul>
<p>El <span class="math inline">\(p-valor\)</span> asociado a la interacción es menor que <span class="math inline">\(0.05\)</span>, lo que indica que la interacción entre el método de enseñanza y el tipo de material de estudio es significativa y por lo tanto no debe ser eliminada del modelo.</p>
<p>Efectivamente, viendo la figura anterior concluimos que el rendimiento depende de la interacción entre los dos factores. Así, por ejemplo, cuando el matería es proporcionado de modo “online” o en “vídeo” el rendimiento es más elevado en el método experimental que en el método tradicional. La diferencia entre los dos métodos es especialmente notable cuando el material es “online”. Sin embargo, cuando el material se ofrece en modo “libro” el método tradicional ofrece mejores resultados que el método experimental.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo. ANOVA de dos factores no significativos">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo. ANOVA de dos factores no significativos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supongamos que estamos estudiando el efecto del tipo de fertilizante (con dos niveles: <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span>) y el tipo de riego (con tres niveles: Goteo, Aspersión, Manual) sobre el crecimiento de las plantas.</p>
<p>En primer lugar observamos los datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos simulados</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>crecimiento <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">29</span>, <span class="dv">28</span>, <span class="dv">30</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>fertilizante <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each=</span><span class="dv">18</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>riego <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Goteo"</span>, <span class="st">"Aspersión"</span>, <span class="st">"Manual"</span>), <span class="at">each=</span><span class="dv">6</span>, <span class="at">times=</span><span class="dv">2</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un data frame</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(crecimiento, fertilizante, riego)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar los datos</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggline</span>(datos, <span class="at">x =</span> <span class="st">"riego"</span>, <span class="at">y =</span> <span class="st">"crecimiento"</span>, <span class="at">color =</span> <span class="st">"fertilizante"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_se"</span>, <span class="st">"dotplot"</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/datos_anova2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Realizamos el ANOVA de dos factores con interacción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de dos factores con interacción</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(crecimiento <span class="sc">~</span> fertilizante <span class="sc">*</span> riego, <span class="at">data=</span>datos)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Df Sum Sq Mean Sq F value   Pr(&gt;F)    
fertilizante        1   36.0   36.00  12.000  0.00162 ** 
riego               2    3.5    1.75   0.583  0.56424    
fertilizante:riego  2  283.5  141.75  47.250 5.36e-10 ***
Residuals          30   90.0    3.00                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>El <span class="math inline">\(p-valor\)</span> asociado a la interaccióni es mayor que <span class="math inline">\(0.05\)</span> lo, lo que indica que la interacción entre el tipo de fertilizante y el tipo de riego no es significativa y debe de ser eliminada del modelo.</p>
<p>Por tanto, obtenemos la tabla ANOVA para los dos factores sin interacción:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de dos factores sin interacción</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(crecimiento <span class="sc">~</span> fertilizante <span class="sc">+</span> riego, <span class="at">data=</span>datos)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)  
fertilizante  1   36.0   36.00   3.084 0.0886 .
riego         2    3.5    1.75   0.150 0.8614  
Residuals    32  373.5   11.67                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Una vez eliminado el efecto de la interacción del modelo, podemos observar como ninguno de los dos factores para estadísticamente significativo, puesto que los <span class="math inline">\(p-valores\)</span> asociados son mayores que <span class="math inline">\(0.05\)</span>. Sin embargo, hemos de actuar con cautela. Veamos el modelo cuando se elimina el factor menos significativo <code>riego</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de un factor</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(crecimiento <span class="sc">~</span> fertilizante, <span class="at">data=</span>datos)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)  
fertilizante  1     36   36.00   3.247 0.0804 .
Residuals    34    377   11.09                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Al nivel de significancia estadística de <span class="math inline">\(0.05\)</span> podríamos decir que el factor <code>fertilizante</code> no es estadísticamente significativo y que ninguno de los dos factores influye en el crecimiento de las planteas.</p>
<p>Ahora bien, si tuvieras que elegir un método de riego y un fertilizando, ¿cuál recomendarías al cliente? ¿por qué?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo. ANOVA de dos factores sin interacción">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo. ANOVA de dos factores sin interacción
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supongamos que estamos estudiando del tiempo de estudio y del tipo de dieta en el rendimiento académico de un grupo de estudiantes. El tiempo de estudio tiene <span class="math inline">\(3\)</span> niveles (Alto, Medio y Bajo). El tipo de dieta tiene <span class="math inline">\(3\)</span> niveles (Normal, Vegana y Vegetariana).</p>
<p>En primer lugar observamos los datos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tiempo_estudio =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"1. Alto"</span>, <span class="st">"2. Medio"</span>, <span class="st">"3. Bajo"</span>), <span class="at">each =</span> <span class="dv">9</span>)),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo_dieta =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Vegetariana"</span>, <span class="st">"Normal"</span>, <span class="st">"Vegana"</span>), <span class="at">times =</span> <span class="dv">9</span>)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rendimiento =</span> <span class="fu">c</span>(<span class="dv">81</span>, <span class="dv">71</span>, <span class="dv">90</span>, <span class="dv">75</span>, <span class="dv">84</span>, <span class="dv">81</span>, <span class="dv">91</span>, <span class="dv">100</span>, <span class="dv">98</span>, <span class="co"># Datos para Nivel1 de Factor1</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                <span class="dv">60</span>, <span class="dv">83</span>, <span class="dv">70</span>, <span class="dv">54</span>, <span class="dv">65</span>, <span class="dv">73</span>, <span class="dv">82</span>, <span class="dv">92</span>, <span class="dv">73</span>, <span class="co"># Datos para Nivel2 de Factor1</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                <span class="dv">47</span>, <span class="dv">63</span>, <span class="dv">44</span>, <span class="dv">61</span>, <span class="dv">55</span>, <span class="dv">52</span>, <span class="dv">73</span>, <span class="dv">63</span>, <span class="dv">53</span>) <span class="co"># Datos para Nivel3 de Factor1</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggline</span>(datos, <span class="at">x =</span> <span class="st">"Tiempo_estudio"</span>, <span class="at">y =</span> <span class="st">"Rendimiento"</span>, <span class="at">color =</span> <span class="st">"Tipo_dieta"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_se"</span>, <span class="st">"dotplot"</span>),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>,<span class="st">"#c94545"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/datos_anova2_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Realizamos el ANOVA de dos factores con interacción.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de dos factores con interacción</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Rendimiento <span class="sc">~</span> Tiempo_estudio <span class="sc">*</span> Tipo_dieta, <span class="at">data =</span> datos)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Tiempo_estudio             2   3765  1882.3  17.410 6.2e-05 ***
Tipo_dieta                 2    169    84.6   0.782   0.472    
Tiempo_estudio:Tipo_dieta  4    465   116.1   1.074   0.398    
Residuals                 18   1946   108.1                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>La interacción entre los dos factores no es estadísticamente significativa a nivel <span class="math inline">\(\alpha=0.05\)</span> y por lo tanto eliminamos dicha fuente de variabilidad del modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de dos factores sin interacción</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Rendimiento <span class="sc">~</span> Tiempo_estudio <span class="sc">+</span> Tipo_dieta, <span class="at">data =</span> datos)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Tiempo_estudio  2   3765  1882.3  17.178 3.21e-05 ***
Tipo_dieta      2    169    84.6   0.772    0.474    
Residuals      22   2411   109.6                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Podemos observar que el tipo de dieta no es un factor significativo en el rendimiento académico. Por tanto, eliminamos dicho factor del modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar el ANOVA de un factor</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Rendimiento <span class="sc">~</span> Tiempo_estudio , <span class="at">data =</span> datos)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los resultados del ANOVA</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Tiempo_estudio  2   3765  1882.3   17.51 2.04e-05 ***
Residuals      24   2580   107.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>En cambio, el tiempo de estudio sí es un factor determinante en el rendimiento académico. Su <span class="math inline">\(p-valor\)</span> asociado es claramente inferior al nivel de significancia <span class="math inline">\(0.05\)</span>.</p>
<p>Podemos visualizar el resultado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggline</span>(datos, <span class="at">x =</span> <span class="st">"Tiempo_estudio"</span>, <span class="at">y =</span> <span class="st">"Rendimiento"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">add =</span> <span class="fu">c</span>(<span class="st">"mean_se"</span>, <span class="st">"dotplot"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/anova_rend4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparaciones-múltiples" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="comparaciones-múltiples"><span class="header-section-number">5.3</span> Comparaciones múltiples</h2>
<p>En el último ejemplo del apartado anterior hemos determinado que un factor con <span class="math inline">\(3\)</span> niveles era estadísticamente significativo. Es decir, podemos rechazar la siguiente hipótesis nula:</p>
<p><span class="math display">\[H_O: \mu_1=\mu_2\ldots = \mu_k\]</span> (con <span class="math inline">\(k\)</span> igual al número de niveles en el factor). Podemos plantearnos la pregunta siguiente: ¿En qué niveles del factor se encuentran las principales diferencias? Es decir, qué hipotesis (una o varias) de las siguientes son rechazadas: <span class="math display">\[H_O: \mu_1=\mu_2\]</span> <span class="math display">\[H_O: \mu_1=\mu_3\]</span> <span class="math display">\[\ldots\]</span> <span class="math display">\[H_O: \mu_{k-1} = \mu_k\]</span></p>
<p>En un ejemplo con <span class="math inline">\(k=3\)</span> niveles en el factor, es posible plantear <span class="math inline">\(3\)</span> contrastes de igualdad de medias, como los estudiados en capítulos anteriores. En un ejemplo con <span class="math inline">\(k\)</span> niveles en el factor, es posible plantear <span class="math inline">\(k*(k-1)/2\)</span> posibles contrastes de igualda de medias. Sin embargo, si realizamos todos estos contrastes, aumenta la probabilidad de cometer errores de tipo I (rechazar incorrectamente la hipótesis nula). Este fenómeno se conoce como el <strong>problema de las pruebas múltiples</strong>.</p>
<p>Como hemos venido viendo, cuando realizamos una sola prueba de hipótesis (por ejemplo, una prueba <span class="math inline">\(t\)</span> de Student o un ANOVA), generalmente establecemos un nivel de significancia predeterminado, como <span class="math inline">\(\alpha = 0.05\)</span>. Esto significa que estamos dispuestos a aceptar una probabilidad de error de tipo I del <span class="math inline">\(5\%\)</span>, es decir, hay un <span class="math inline">\(5\%\)</span> de probabilidad de rechazar incorrectamente la hipótesis nula cuando es verdadera.</p>
<p>Sin embargo, cuando realizamos múltiples pruebas de hipótesis, la probabilidad acumulada de cometer al menos un error de tipo I aumenta significativamente con cada prueba adicional. Por ejemplo, si realizamos <span class="math inline">\(10\)</span> pruebas de hipótesis independientes, cada una con un nivel de significancia de <span class="math inline">\(\alpha = 0.05\)</span>, la probabilidad de cometer al menos un error de tipo I aumenta a más del <span class="math inline">\(40\%\)</span> (<span class="math inline">\(1-(1-0.05)^{10}\approx 0.401\)</span>.</p>
<p>Existe una solución, <strong>las comparaciones múltiples</strong> necesarias para controlar este aumento en el riesgo de error. Existen varios métodos para controlar el problema de las pruebas múltiples, como los ajustes de Bonferroni, Holm-Bonferroni, Holm, Hochberg, Benjamini-Hochberg (FDR), entre otros. Estos métodos controlan la tasa global de error de tipo I para todas las comparaciones realizadas, manteniendo un nivel de significancia general específico.</p>
<section id="método-de-bonferroni" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="método-de-bonferroni"><span class="header-section-number">5.3.1</span> Método de Bonferroni</h3>
<p>El método de Bonferroni es una técnica comúnmente utilizada para corregir el problema de las comparaciones múltiples y controlar el riesgo de error de tipo I. Este método es relativamente simple y conservador, lo que lo hace popular en muchas aplicaciones estadísticas.</p>
<p>La idea principal detrás del método de Bonferroni es ajustar el nivel de significancia individual para cada prueba de hipótesis realizada. En lugar de utilizar un nivel de significancia estándar (por ejemplo, <span class="math inline">\(\alpha = 0.05\)</span>), dividimos el nivel de significancia global deseado (generalmente <span class="math inline">\(0.05\)</span>) por el número total de pruebas realizadas (<span class="math inline">\(m\)</span>): <span class="math display">\[
\alpha' = \frac{\alpha}{m}
\]</span> Esta división produce un nivel de significancia más estricto (<span class="math inline">\(\alpha'\)</span>) para cada prueba individual, lo que ayuda a controlar el riesgo global de error de tipo I.</p>
<p>Utilizamos el nivel de significancia individual ajustado para cada prueba de hipótesis. Si el <span class="math inline">\(p-valor\)</span> de una prueba es menor que el nivel de significancia ajustado, rechazamos la hipótesis nula de la prueba.</p>
<p>El método de Bonferroni es fácil de entender e implementar, y proporciona un control conservador sobre el error de tipo I en comparaciones múltiples. No obstante puede ser un método demasiado conservador en situaciones donde se realizan muchas comparaciones, lo que puede resultar en una pérdida de potencia estadística. Además, no tiene en cuenta la correlación entre las pruebas realizadas.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Ejemplo. Comparaciones múltiples">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo. Comparaciones múltiples
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Continuamos con el ejemplo anterior anterior sobre la influencia del tiempo de estudio en el rendimiento académico. Hemos visto que existe una relación entre ambos factores. En otras palabras, hemos rechazado la siguiente hipótesis nula:</p>
<p><span class="math display">\[
H_0: \mu_{Alto}=\mu_{Medio}=\mu_{Bajo}
\]</span> Pero, ¿dónde se encuentran las diferencias relevantes?. Calculamos las tres medias muestrales</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(datos[datos<span class="sc">$</span>Tiempo_estudio<span class="sc">==</span><span class="st">"1. Alto"</span>,]<span class="sc">$</span>Rendimiento)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 85.66667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(datos[datos<span class="sc">$</span>Tiempo_estudio<span class="sc">==</span><span class="st">"2. Medio"</span>,]<span class="sc">$</span>Rendimiento)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72.44444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(datos[datos<span class="sc">$</span>Tiempo_estudio<span class="sc">==</span><span class="st">"3. Bajo"</span>,]<span class="sc">$</span>Rendimiento)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56.77778</code></pre>
</div>
</div>
<p>Aplicamos el método de Bonferroni, y obtenemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(datos<span class="sc">$</span>Rendimiento, <span class="at">g=</span>datos<span class="sc">$</span>Tiempo_estudio,<span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  datos$Rendimiento and datos$Tiempo_estudio 

         1. Alto 2. Medio
2. Medio 0.037   -       
3. Bajo  1.3e-05 0.011   

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>Dado que todos los <span class="math inline">\(p-valores\)</span> ajustados son menores que <span class="math inline">\(0.05\)</span>, podemos rechazar las <span class="math inline">\(3\)</span> hipótesis nulas. Es decir, rechazamos que el rendimiento sea el mismo para los diferentes niveles de tiempos de estudio.</p>
<p>Y en <code>R</code> podemos pintarlo como sigue (aquí empleamos otro método de corrección diferente al de Bonferroni, revísalo)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>comparaciones_mult <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparaciones_mult)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="anova_files/figure-html/plot_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./nopara.html" class="pagination-link" aria-label="Contraste no paramétrico">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Contraste no paramétrico</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclusiones.html" class="pagination-link" aria-label="Conclusiones">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusiones</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>